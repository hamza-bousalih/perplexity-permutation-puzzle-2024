## **Perplexity Permutation Puzzle 2024**

## Submitions
![alt text](./imgs/image.png)
![alt text](./imgs/image1.png)

### **Problem Goal**
The goal of the problem is to rearrange jumbled words in sequences to form coherent and fluent sentences. The fluency and coherence of a sentence are quantitatively evaluated using a **perplexity** score, with lower perplexity indicating better quality. The challenge lies in efficiently exploring the vast combinatorial solution space of possible permutations to find the optimal arrangement.

### **The Problem**
1. **Nature of the Problem**:  
   - **Type**: Combinatorial optimization problem.
   - **Input**: Jumbled sequences of words.
   - **Output**: Rearranged sequences with minimized perplexity scores.
   - **Evaluation Metric**: Perplexity calculated using the [Gemma 2 9B](https://www.kaggle.com/models/google/gemma-2/Transformers/gemma-2-9b/2) language model.

2. **Solution Space**:  
   - **Definition**: For a sequence of ` n ` words, the solution space comprises all possible permutations (` n! `).
   - **Characteristics**:
     - Large size due to factorial growth (` n! `).
     - Each permutation is discrete and distinct.
   - **Constraints**:
     - Every solution must be a valid permutation of the input sequence.
     - The goal is to find the permutation with the lowest perplexity score.

### **Proposed Metaheuristic Approach**
<!-- To address the combinatorial nature of the problem, metaheuristics such as **Simulated Annealing**, **Genetic Algorithms**, or **Swarm Optimization** can be employed. Below, we outline a framework based on metaheuristic techniques: -->

#### **Solution Representation**
- A solution is a specific permutation of words in a sequence.
- Example:
  - Input: `["coming", "is", "Santa"]`
  - Solution: `["Santa", "is", "coming"]`

#### **Solution Movements**
Movements define how to transition from one solution to another within the solution space. Key operators include:

1. **Word Swaps**:  
   - Swap the positions of two words in the sequence.  
   - Example:
     - Original: `["Santa", "is", "coming"]`
     - After Swap: `["is", "Santa", "coming"]`

2. **Mutation**:  
   - Introduce a random rearrangement of the sequence by shuffling groups of words or performing multiple swaps.  
   - Example:
     - Original: `["Santa", "is", "coming"]`
     - After Mutation: `["coming", "is", "Santa"]`

3. **Insertion**:  
   - Move a word to a new position in the sequence.  
   - Example:
     - Original: `["Santa", "is", "coming"]`
     - After Insertion: `["Santa", "coming", "is"]`

#### **Evaluation Function**
The quality of a solution is evaluated using the **perplexity score** generated by the **Gemma 2 9B** model. The objective is to minimize this score, ensuring semantic coherence and fluency in the rearranged sequence.


### **Algorithm Design**
We propose a hybrid algorithm combining **Whale Optimization Algorithm (WOA)** for global exploration and **Tabu Search** for local refinement.  

1. **Initialization**:  
   - Generate an initial population of random permutations.  
   - Define a tabu list to track recently visited solutions in local search (to avoid cycling).  
   - Set parameters for WOA (e.g., population size, convergence factor) and Tabu Search (e.g., tabu list size, maximum iterations).

2. **Global Search (Whale Optimization Algorithm)**:  
   The WOA mimics the bubble-net hunting strategy of whales. Each candidate solution represents a permutation of words in a sequence.

3. **Local Search (Tabu Search)**:  
   For the best candidates selected by WOA, refine their positions using **Tabu Search**:  
   - **Neighborhood Generation**:  
     Generate neighbors by performing swaps, insertions, or mutations on the current sequence.  
   - **Tabu List**:  
     Maintain a list of recently visited permutations to avoid revisiting them.  
   - **Aspiration Criterion**:  
     Allow tabu moves if they lead to a solution with significantly lower perplexity.  
   - **Update**:  
     Replace the current solution with the best non-tabu neighbor.

4. **Termination**:  
   - Stop the search when the maximum number of iterations is reached, or no significant improvement is observed in the best perplexity score for a given number of iterations.

### **Advantages of WOA + Tabu Search**
- **Whale Optimization** provides robust global search capabilities, leveraging both exploration and exploitation.  
- **Tabu Search** enhances local refinement by systematically exploring the neighborhood while avoiding cycling.  
- The hybrid approach balances diversity and intensification, effectively handling the large combinatorial solution space.